# Intelligent Network Analyzer

Hybrid cybersecurity assessment platform built with FastAPI. It correlates active Nmap scanning with Shodan passive intelligence, computes risk, stores history in SQLite, exposes a terminal-style web UI, and can generate PDF audit reports.

## What It Does
- **Active scanning (Nmap):** Discovers open ports/services and basic OS hints (quick/full modes).
- **Passive intelligence (Shodan):** Resolves targets, validates public exposure, fetches ISP/Country, open ports, and CVE list.
- **Correlation & risk scoring:** Custom `RiskAnalyzer` computes a 0–10 score and severity (LOW/MEDIUM/HIGH/CRITICAL) based on ports, dangerous services, public exposure overlap, and CVEs, producing human-readable findings.
- **Persistence:** Saves every scan to SQLite (`scanner.db`) with full JSON payload and risk summary.
- **History API:** Fetch the 10 most recent scans via `/history`.
- **Terminal-style web UI:** Single-page, dark monospace UI at `/` to trigger scans, view structured results, clear logs, and download JSON.
- **PDF reports:** Generate corporate-style audit PDFs per scan via `/report/{scan_id}` (ReportLab).

## Project Structure
```
app/
  core/
    scanner.py       # Nmap integration and parsing
    intelligence.py  # Shodan integration with resolution/public-IP guard
    analyzer.py      # Risk scoring engine
    reporter.py      # PDF generation (ReportLab)
  db/
    database.py      # SQLAlchemy engine/session/Base
    models.py        # ScanRecord ORM model
  models/
    schemas.py       # Pydantic models (request/response/history/risk)
  main.py            # FastAPI app, routes, UI, orchestration
requirements.txt
```

## Setup
1. Clone and create virtualenv (Python 3.11+ recommended).
2. Install deps:
   ```bash
   pip install -r requirements.txt
   ```
3. Add `.env` with your Shodan API key:
   ```
   SHODAN_API_KEY=your_key_here
   ```
4. Run the server:
   ```bash
   uvicorn app.main:app --reload
   ```
5. Open the UI at `http://localhost:8000/`.

## Usage
- **Trigger a scan (UI):** Enter target IP/hostname, choose quick/full, click `run`. Results render as a structured block (risk chip, ports table, intel, findings). Clear logs or download the last JSON via toolbar buttons.
- **Trigger a scan (API):**
  ```bash
  curl -X POST http://localhost:8000/scan \
    -H "Content-Type: application/json" \
    -d '{"target":"8.8.8.8","scan_type":"quick"}'
  ```
- **View history:** `GET /history` returns the last 10 records (id, target, timestamp, risk score/level).
- **Download PDF report:** `GET /report/{scan_id}` uses the stored scan to emit a PDF saved under `reports/` and streamed to the client.

## Risk Scoring (analyzer.py)
- Base: +0.2 per non-standard open port.
- Dangerous ports: 21 +1.5, 22 +1.0, 23 +2.5, 3389 +2.5, 445 +3.0.
- Public exposure: if Shodan finds the host, +2.0; if Shodan ports overlap local ports, +1.0.
- CVEs: each CVE +1.5.
- Clamped 0–10 with labels LOW/MEDIUM/HIGH/CRITICAL. Findings list explains contributors.

## Data Model (SQLite via SQLAlchemy)
- `scans` table:
  - `id` (PK)
  - `target_ip`
  - `timestamp`
  - `risk_score`
  - `risk_level`
  - `scan_data` (full JSON payload as text)

## API Summary
- `POST /scan` → `ScanResult` (active services, intel, risk).
- `GET /history` → last 10 `ScanHistoryItem`.
- `GET /report/{scan_id}` → PDF download (ReportLab), saved to `reports/`.
- `GET /` → terminal-style web UI.

## Frontend Notes
- Dark monospace terminal aesthetic; no external CSS frameworks.
- Structured result rendering (no raw JSON): risk chip with color, grid table for ports, intel summary, bullet findings.
- Toolbar: clear logs, download last result (JSON Blob).

## Error Handling & Edge Cases
- Shodan lookups: resolve hostnames, reject private/reserved IPs gracefully with status/message.
- Scanner errors propagate as HTTP 500 with detail; UI shows error line.
- PDF generation validates stored JSON; returns 500 if corrupted scan data.

## Extensibility Ideas
- Add authentication/roles for multi-user deployments.
- Expand history filters/pagination; add delete/archive.
- Add CVSS-aware scoring and service-specific heuristics.
- Add scheduled scans and notifications.
- Enhance PDF with branding and charts.

## License / Attribution
Generated by Intelligent Network Analyzer - B.Tech Final Year Project. Customize licensing as needed for your deployment.
